Задание
1. Попасть в систему без пароля несколькими способами
2. Установить систему с LVM, после чего переименовать VG
3. Добавить модуль в initrd

###############################################################################################################
1. Попасть в систему без пароля несколькими способами

Способ 1. init=/bin/sh
Развернул новую ВМ Ubuntu 20.04 на базе virtualbox 
По умолчанию в настройках grub ubuntu 20.04 не установлен TIMEOUT и меню загрузки скрыто
GRUB_TIMEOUT_STYLE=hidden
GRUB_TIMEOUT=0
меняю на 
GRUB_TIMEOUT_STYLE=menu
GRUB_TIMEOUT=20
делаю update-grub
перегружаю ВМ и появляется меню выбоа при старет ВМ.
нажимаю e . Попадаю в окно, где можно изменить параметры загрузки:
В конце строки, начинающейся с linux, добавляю  init=/bin/bash и нажимаю сtrl-x для загрузки в систему
попадаю в консоль
проверяю что корневая ФС  примонтирована в режиме ro командой mount
перемонтирую ФС в режим Read-Write  командой: mount -o remount,rw /
проверяю командой mount. Корневая ФС примонтирована в режиме RW.
проверяю запись командой echo "123" > /root/test.txt
перегружаю ВМ и проверяю файл. 



Способ 2. в режиме Rescue (режим помощи)
Нажимаю e . Попадаю в окно, где можно изменить параметры загрузки:
В конце строки, начинающейся с linux, добавляю «systemd.unit = rescue.target» и нажимаю сtrl-x 
Во время загрузки выведет сообщение где нужно нажать  «Enter» и система загрузиться в режиме восстановления
Корневая ФС примонтирована в режиме RW
Меняю пароль на пользователя командой passwd и перегружаю ВМ
перегружаю ВМ и проверяю смену пароля - успешно



Способ 3. в режиме Emergency (Аварийный режим)
Нажимаю e . Попадаю в окно, где можно изменить параметры загрузки:
В конце строки, начинающейся с linux, добавляю «systemd.unit = emergency.target» и нажимаю сtrl-x 
mount -o remount ,rw /
остальное аналогично предыдущим пунктам


###############################################################################################################

2. Установить систему с LVM, после чего переименовать VG

Первым делом посмотрим текущее состояние системы:
root@tep:~# vgs
  VG        #PV #LV #SN Attr   VSize   VFree
  ubuntu-vg   1   1   0 wz--n- <23,00g 11,50g

Приступим к переименованию:
root@tep:~# vgrename ubuntu-vg OtusRoot
  Volume group "ubuntu-vg" successfully renamed to "OtusRoot"
root@tep:~#

Далее правлю /etc/default/grub Везде заменяем старое название на новое
Пересоздаем initrd image, чтобы он знал новое название Volume Group
update-initramfs -u
root@tep:~# update-initramfs -u
update-initramfs: Generating /boot/initrd.img-5.4.0-176-generic
root@tep:~#
После чего перезагружаю и проверяею:
root@tep:~# vgs
  VG       #PV #LV #SN Attr   VSize   VFree
  OtusRoot   1   1   0 wz--n- <23,00g 11,50g
root@tep:~#

###############################################################################################################
3. Добавить модуль в initrd

Скрипты модулей хранятся в каталоге /usr/lib/dracut/modules.d/. 
Для того, чтобы добавить свой модуль, создаею там папку с именем 01test
Копирую содержимое скриптов в файлы module-setup.sh и test.sh
Пересобираем образ initrd - update-initramfs -u
Ставлю пакет для dracut - apt install dracut-core
выполняю  dracut -f -v
проверка
root@tep:~#  lsinitrd -m /boot/initramfs-$(uname -r).img | grep test
test
root@tep:~#

###############################################################################################################